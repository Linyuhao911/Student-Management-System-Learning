{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.json.parse.js\";\nexport default {\n  name: \"Password\",\n  data() {\n    // 验证确认密码与新密码一致性\n    const validateConfirmPassword = (rule, value, callback) => {\n      if (!value) {\n        callback(new Error('请输入确认密码'));\n      } else if (value !== this.user.newPassword) {\n        callback(new Error('两次输入的密码不一致'));\n      } else {\n        callback();\n      }\n    };\n\n    // 验证新密码强度\n    const validateNewPassword = (rule, value, callback) => {\n      if (!value) {\n        callback(new Error('请输入新密码'));\n      } else if (value.length < 8) {\n        callback(new Error('密码长度不能少于8位'));\n      } else if (!/[A-Za-z]/.test(value) || !/\\d/.test(value)) {\n        callback(new Error('密码必须包含字母和数字'));\n      } else if (value === this.user.password) {\n        callback(new Error('新密码不能与原始密码相同'));\n      } else {\n        callback();\n      }\n    };\n    return {\n      user: {\n        password: '',\n        newPassword: '',\n        confirmPassword: '',\n        id: JSON.parse(localStorage.getItem(\"user\")).id\n      },\n      rules: {\n        password: [{\n          required: true,\n          message: '请输入原始密码',\n          trigger: 'blur'\n        }],\n        newPassword: [{\n          validator: validateNewPassword,\n          required: true,\n          trigger: 'blur'\n        }],\n        confirmPassword: [{\n          validator: validateConfirmPassword,\n          required: true,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    // 重置表单\n    resetForm() {\n      this.$refs.formRef.resetFields();\n    },\n    // 提交密码修改\n    update() {\n      console.log(this.user);\n      this.$refs.formRef.validate(async valid => {\n        if (valid) {\n          try {\n            // 准备提交的数据，只包含必要字段\n            const submitData = {\n              id: this.user.id,\n              newPassword: this.user.newPassword,\n              password: this.user.password\n            };\n            const res = await this.$request.post('/user/password', submitData);\n            if (res.code === '200') {\n              this.$notify.warning({\n                title: '成功',\n                message: '密码修改成功，请重新登录',\n                showClose: false,\n                duration: 2000\n              });\n\n              // 清除本地存储的用户信息，确保安全退出\n              localStorage.removeItem('user');\n              localStorage.removeItem('userId');\n              // 延迟跳转，让用户看到成功提示\n              setTimeout(() => {\n                this.$router.push('/login');\n              }, 1500);\n            } else {\n              this.$notify.error({\n                message: res.msg || '修改失败，请稍后重试',\n                showClose: false,\n                duration: 2000\n              });\n            }\n          } catch (error) {\n            this.$notify.error({\n              message: '网络异常，请稍后重试',\n              showClose: false,\n              duration: 2000\n            });\n          }\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["name","data","validateConfirmPassword","rule","value","callback","Error","user","newPassword","validateNewPassword","length","test","password","confirmPassword","id","JSON","parse","localStorage","getItem","rules","required","message","trigger","validator","methods","resetForm","$refs","formRef","resetFields","update","console","log","validate","valid","submitData","res","$request","post","code","$notify","warning","title","showClose","duration","removeItem","setTimeout","$router","push","error","msg"],"sources":["src/views/front/Password.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"content\">\r\n      <el-card class=\"password-card\">\r\n        <div class=\"card-header\">密码修改</div>\r\n        <el-form ref=\"formRef\" :model=\"user\" :rules=\"rules\" label-width=\"80px\" class=\"password-form\">\r\n          <el-form-item label=\"原始密码\" prop=\"password\">\r\n            <el-input show-password v-model=\"user.password\" placeholder=\"请输入原始密码\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n            <el-input show-password v-model=\"user.newPassword\" placeholder=\"新密码长度至少8位，包含字母和数字\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"确认密码\" prop=\"confirmPassword\">\r\n            <el-input show-password v-model=\"user.confirmPassword\" placeholder=\"请再次输入新密码\" clearable></el-input>\r\n          </el-form-item>\r\n          <div class=\"form-actions\">\r\n            <el-button type=\"warning\" @click=\"resetForm\">重置</el-button>\r\n            <el-button type=\"primary\" @click=\"update\">确认修改</el-button>\r\n          </div>\r\n        </el-form>\r\n      </el-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Password\",\r\n  data() {\r\n    // 验证确认密码与新密码一致性\r\n    const validateConfirmPassword = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback(new Error('请输入确认密码'));\r\n      } else if (value !== this.user.newPassword) {\r\n        callback(new Error('两次输入的密码不一致'));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n\r\n    // 验证新密码强度\r\n    const validateNewPassword = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback(new Error('请输入新密码'));\r\n      } else if (value.length < 8) {\r\n        callback(new Error('密码长度不能少于8位'));\r\n      } else if (!/[A-Za-z]/.test(value) || !/\\d/.test(value)) {\r\n        callback(new Error('密码必须包含字母和数字'));\r\n      } else if (value === this.user.password) {\r\n        callback(new Error('新密码不能与原始密码相同'));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    return {\r\n      user: {\r\n        password: '',\r\n        newPassword: '',\r\n        confirmPassword: '',\r\n        id: JSON.parse(localStorage.getItem(\"user\")).id\r\n      },\r\n      rules: {\r\n        password: [{ required: true, message: '请输入原始密码', trigger: 'blur' }],\r\n        newPassword: [{ validator: validateNewPassword, required: true, trigger: 'blur' }],\r\n        confirmPassword: [{ validator: validateConfirmPassword, required: true, trigger: 'blur' }]\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    // 重置表单\r\n    resetForm() {\r\n      this.$refs.formRef.resetFields();\r\n    },\r\n    // 提交密码修改\r\n    update() {\r\n      console.log(this.user)\r\n      this.$refs.formRef.validate(async (valid) => {\r\n        if (valid) {\r\n          try {\r\n            // 准备提交的数据，只包含必要字段\r\n            const submitData = {\r\n              id: this.user.id,\r\n              newPassword: this.user.newPassword,\r\n              password: this.user.password\r\n            };\r\n\r\n            const res = await this.$request.post('/user/password', submitData);\r\n            if (res.code === '200') {\r\n              this.$notify.warning({title: '成功', message: '密码修改成功，请重新登录', showClose: false, duration: 2000});\r\n\r\n              // 清除本地存储的用户信息，确保安全退出\r\n              localStorage.removeItem('user');\r\n              localStorage.removeItem('userId');\r\n              // 延迟跳转，让用户看到成功提示\r\n              setTimeout(() => {\r\n                this.$router.push('/login');\r\n              }, 1500);\r\n            } else {\r\n              this.$notify.error({message: res.msg || '修改失败，请稍后重试', showClose: false, duration: 2000});\r\n            }\r\n          } catch (error) {\r\n            this.$notify.error({message:'网络异常，请稍后重试', showClose: false, duration: 2000});\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* 全局容器样式 - 控制整体页面布局 */\r\n.container {\r\n  min-height: 90vh;          /* 最小高度为视口高度的70%，确保内容区域有足够高度 */\r\n  padding: 20px 20px;        /* 上下内边距40px，左右20px，使内容不贴边 */\r\n  box-sizing: border-box;     /* 盒模型包含padding和border，避免宽度计算问题 */\r\n}\r\n\r\n/* 内容区容器 - 控制表单的居中显示 */\r\n.content {\r\n  display: flex;              /* 使用弹性布局 */\r\n  justify-content: center;    /* 水平方向居中对齐 */\r\n  align-items: flex-start;    /* 垂直方向顶部对齐 */\r\n}\r\n\r\n/* 密码修改卡片样式 - 表单的外层容器 */\r\n.password-card {\r\n  width: 30%;                /* 基础宽度100% */\r\n  max-width: 1000px;           /* 最大宽度限制为500px，避免宽屏上表单过宽 */\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); /* 轻微阴影，增强卡片立体感 */\r\n  border-radius: 8px;         /* 8px圆角，提升视觉体验 */\r\n  overflow: hidden;           /* 隐藏超出容器的内容，配合圆角使用 */\r\n}\r\n\r\n/* 卡片标题样式 - 增强视觉层次感 */\r\n.card-header {\r\n  font-size: 18px;            /* 标题字体大小18px */\r\n  font-weight: 600;           /* 半粗体，突出标题 */\r\n  color: #303133;             /* 深灰色文字，清晰可见 */\r\n  padding: 10px 20px;         /* 内边距，控制标题区域大小 */\r\n  border-bottom: 1px solid #f0f0f0; /* 底部边框，分隔标题与内容 */\r\n  background-color: #fff;     /* 白色背景，与内容区一致 */\r\n}\r\n\r\n/* 表单样式 - 调整表单内部布局 */\r\n.password-form {\r\n  padding: 25px 20px;         /* 内边距，使表单内容与边框有距离 */\r\n  background-color: #fff;     /* 白色背景，提供清晰的输入环境 */\r\n}\r\n\r\n/* 穿透修改Element UI表单标签样式 */\r\n/deep/.el-form-item__label {\r\n  font-weight: 500;           /* 标签字体半粗体，提升可读性 */\r\n  color: #606266;             /* 中灰色，区分标签与输入内容 */\r\n}\r\n\r\n/* 表单操作按钮区域样式 */\r\n.form-actions {\r\n  display: flex;              /* 弹性布局，使按钮水平排列 */\r\n  justify-content: flex-end;  /* 按钮靠右对齐 */\r\n  gap: 10px;                  /* 按钮之间间距10px */\r\n  margin-top: 20px;           /* 上方间距20px，与表单内容分隔 */\r\n  padding-right: 10px;        /* 右侧内边距，避免按钮贴边 */\r\n}\r\n</style>\r\n"],"mappings":";;AA0BA;EACAA,IAAA;EACAC,KAAA;IACA;IACA,MAAAC,uBAAA,GAAAA,CAAAC,IAAA,EAAAC,KAAA,EAAAC,QAAA;MACA,KAAAD,KAAA;QACAC,QAAA,KAAAC,KAAA;MACA,WAAAF,KAAA,UAAAG,IAAA,CAAAC,WAAA;QACAH,QAAA,KAAAC,KAAA;MACA;QACAD,QAAA;MACA;IACA;;IAEA;IACA,MAAAI,mBAAA,GAAAA,CAAAN,IAAA,EAAAC,KAAA,EAAAC,QAAA;MACA,KAAAD,KAAA;QACAC,QAAA,KAAAC,KAAA;MACA,WAAAF,KAAA,CAAAM,MAAA;QACAL,QAAA,KAAAC,KAAA;MACA,uBAAAK,IAAA,CAAAP,KAAA,WAAAO,IAAA,CAAAP,KAAA;QACAC,QAAA,KAAAC,KAAA;MACA,WAAAF,KAAA,UAAAG,IAAA,CAAAK,QAAA;QACAP,QAAA,KAAAC,KAAA;MACA;QACAD,QAAA;MACA;IACA;IACA;MACAE,IAAA;QACAK,QAAA;QACAJ,WAAA;QACAK,eAAA;QACAC,EAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA,UAAAJ;MACA;MACAK,KAAA;QACAP,QAAA;UAAAQ,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAd,WAAA;UAAAe,SAAA,EAAAd,mBAAA;UAAAW,QAAA;UAAAE,OAAA;QAAA;QACAT,eAAA;UAAAU,SAAA,EAAArB,uBAAA;UAAAkB,QAAA;UAAAE,OAAA;QAAA;MACA;IACA;EACA;EACAE,OAAA;IACA;IACAC,UAAA;MACA,KAAAC,KAAA,CAAAC,OAAA,CAAAC,WAAA;IACA;IACA;IACAC,OAAA;MACAC,OAAA,CAAAC,GAAA,MAAAxB,IAAA;MACA,KAAAmB,KAAA,CAAAC,OAAA,CAAAK,QAAA,OAAAC,KAAA;QACA,IAAAA,KAAA;UACA;YACA;YACA,MAAAC,UAAA;cACApB,EAAA,OAAAP,IAAA,CAAAO,EAAA;cACAN,WAAA,OAAAD,IAAA,CAAAC,WAAA;cACAI,QAAA,OAAAL,IAAA,CAAAK;YACA;YAEA,MAAAuB,GAAA,cAAAC,QAAA,CAAAC,IAAA,mBAAAH,UAAA;YACA,IAAAC,GAAA,CAAAG,IAAA;cACA,KAAAC,OAAA,CAAAC,OAAA;gBAAAC,KAAA;gBAAApB,OAAA;gBAAAqB,SAAA;gBAAAC,QAAA;cAAA;;cAEA;cACA1B,YAAA,CAAA2B,UAAA;cACA3B,YAAA,CAAA2B,UAAA;cACA;cACAC,UAAA;gBACA,KAAAC,OAAA,CAAAC,IAAA;cACA;YACA;cACA,KAAAR,OAAA,CAAAS,KAAA;gBAAA3B,OAAA,EAAAc,GAAA,CAAAc,GAAA;gBAAAP,SAAA;gBAAAC,QAAA;cAAA;YACA;UACA,SAAAK,KAAA;YACA,KAAAT,OAAA,CAAAS,KAAA;cAAA3B,OAAA;cAAAqB,SAAA;cAAAC,QAAA;YAAA;UACA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}